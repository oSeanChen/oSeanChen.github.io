<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0"><title>Sean's Blog</title><meta name="author" content="Sean"><meta name="copyright" content="Sean"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://oseanchen.github.io/page/2/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="sy_aItoBmo7s6Mb8wbh97IV_N4jjnUXRzwBNb4brupA"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查詢的內容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '複製成功',
    error: '複製錯誤',
    noSupport: '瀏覽器不支援'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '剛剛',
    min: '分鐘前',
    hour: '小時前',
    day: '天前',
    month: '個月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  }
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Sean\'s Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-02-16 23:14:37'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/profile2.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">10</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-user"></i><span> About Me</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('/img/7212.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="Sean's Blog"><span class="site-name">Sean's Blog</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜尋</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa-solid fa-user"></i><span> About Me</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Sean's Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="mailto:abbb123p@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/31/Rails/Rails-%E5%A5%97%E4%BB%B6%E6%93%8D%E4%BD%9C%EF%BC%8CDevise%EF%BC%88google-%E7%AC%AC%E4%B8%89%E6%96%B9%E7%99%BB%E5%85%A5%EF%BC%88%E4%B8%8A%EF%BC%89/" title="Rails 套件操作，Devise（google 第三方登入（上）)">Rails 套件操作，Devise（google 第三方登入（上）)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-31T07:34:58.000Z" title="發表於 2022-10-31 15:34:58">2022-10-31</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%A5%97%E4%BB%B6/">Rails套件</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Ruby/">Ruby</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Rails/">Rails</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Devise/">Devise</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E5%A5%97%E4%BB%B6/">套件</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E6%9C%83%E5%93%A1%E7%B3%BB%E7%B5%B1/">會員系統</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/google/">google</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/github/">github</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Omniauth/">Omniauth</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/Oauth/">Oauth</a></span></div><div class="content">相信很多人主要是希望可以透過 devise 來幫忙串接第三方登入，這部分剛好在我們製作專案的時候有順利完成 google 的部分就拿出來分享給大家。
主要步驟
申請 google api 金鑰
專案中 devise 設定檔設定金鑰
裝上 omniauth 套件配合串接 devise
設定 routes
設定 callback controller
設定 model

這篇先針對前面三點進行說明。
申請 google oauth 金鑰先到 google cloud 去申請 oauth 金鑰https://console.cloud.google.com/
點選 oauth 用戶端 id 進入申請頁面
填寫的部分：

應用程式類型選“網頁應用程式”
名稱就自己決定
已授權的 javascript 來源先填上 localhost 的位置 (http://127.0.0.1:3000) or (http://localhost:3000)，方便你本機可以進行測試，建議上面兩種都填寫，防止你開 server 連到沒加入金鑰的那個位置，之後上線後記得也補上正式上線的網域。
已授權的重新導向 url ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/28/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9AModel-%E9%97%9C%E8%81%AF%E6%80%A7-N-N%EF%BC%89/" title="進入Rails世界必須懂：Model 關聯性 (N:N）">進入Rails世界必須懂：Model 關聯性 (N:N）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-28T02:13:45.000Z" title="發表於 2022-10-28 10:13:45">2022-10-28</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">多對多 N:N關於多對多繼續用飲料店的例子舉例說明，可以想像我們很多間飲料店品牌，有很多飲料品項是相同的或不同，就會有需要有一張第三方表單來記錄：

一間飲料店可以有很多種飲料
store has many drinks


同一種飲料可以被很多間不同的飲料店販賣
drink has many stores



我們可以透過這張表單來知道，哪間店有賣哪些飲料，哪些飲料有被哪些店家販售。他們之間的關係可以透過下面這張圖片看到，虛線的 has many 表示他們並不是真的直接有一對多的關聯，而是需要透過第三方表格來建立多對多關聯。

我們可以建立第三方的表格 drink_invest 來記錄飲料和店家之間的關係rails g model drink_invest store:references drink:references
加上 reference 或是 belongs_to 都可以讓這個表格自動建立出對應的 store_id 及 drink_id 欄位，並且可以：

自動加上索引（index），加快查詢
自動幫 Model 加上 belongs_to

需要建立這樣的第三方表格來 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/27/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9AModel-%E9%97%9C%E8%81%AF%E6%80%A7-1-N/" title="進入Rails世界必須懂：Model 關聯性 (1:N)">進入Rails世界必須懂：Model 關聯性 (1:N)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-27T01:39:01.000Z" title="發表於 2022-10-27 09:39:01">2022-10-27</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">1:N 一對多如果我們希望每間商店可以販售許多種飲料，可以使用一對多模式來進行關連。
先建立 Drink 這個 Model：rails g model Drink name price:decimal store_id:integer
目前的資料關聯設計像下圖
先把 model 之間的關聯建立好
drink.rb
123class Drink &lt; ApplicationRecord  belongs_to :storesend

store.rb
1234class Store &lt; ApplicationRecord  has_many :drinks  belongs_to :ownerend

方法建立跟 has_one 一樣，設定 has_many :drinks 後會多了以下幾個方法，belongs_to 建立的方法跟 1:1 是一樣，這邊就不多提：

drinksdrinks&#x3D;buildcreate

console 測試看看123456789101112131415161718192021222324252627282930313233343536#  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/23/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9AModel-%E9%97%9C%E8%81%AF%E6%80%A7-1-1/" title="進入Rails世界必須懂：Model 關聯性 (1:1)">進入Rails世界必須懂：Model 關聯性 (1:1)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-23T14:10:19.000Z" title="發表於 2022-10-23 22:10:19">2022-10-23</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">想好好學會 rails，不得不好好認識相當重要的關聯性，能夠理解並善用的話，你就能在各個 model 之間進行資料庫的溝通，拿到你想要的資料。
Model 關聯性Rails 的 Model 關聯主要有三種類型

一對一 (1:1)
一對多 (1:N)
多對多 (N:N)

今天這部分章節，會優先介紹 1 對 1。我們用實際的例子來進行說明會更加清楚。
1:1 一對一假如我們今天想要開一間飲料店我們會有一個店長 Owner一個店長會有一間店 Store
假設每個店長可以開一間店，這種關係就是一對一的關係。&#x3D;&gt; Owner has one store
可以先從 rails 中產生 Owner 的 Model 並生成對應的資料表來記錄店長的資訊
1rails g model Owner name phone:integer


再產生 Store 的 Model 並生成對應的資料表來記錄商店的資訊，由於需要多一個 owner_id 所以透過指令 owner:references 或是 owner:belongs_to 來產生，這一個欄位可以讓我們知道
12rails g mo ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/22/%E7%80%8F%E8%A6%BD%E5%99%A8%E8%BC%B8%E5%85%A5%E7%B6%B2%E5%9D%80%E5%BE%8C%E5%88%B0%E5%87%BA%E7%8F%BE%E9%A0%81%E9%9D%A2%E6%9C%83%E7%99%BC%E7%94%9F%E4%BB%80%E9%BA%BC%E4%BA%8B%E6%83%85%EF%BC%9F/" title="瀏覽器輸入網址後到出現頁面會發生什麼事情？">瀏覽器輸入網址後到出現頁面會發生什麼事情？</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-22T14:29:22.000Z" title="發表於 2022-10-22 22:29:22">2022-10-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E7%B6%B2%E8%B7%AF%E6%A6%82%E5%BF%B5/">網路概念</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/REST/">REST</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/RESTful/">RESTful</a><span class="article-meta-link">•</span><a class="article-meta__tags" href="/tags/%E7%B6%B2%E8%B7%AF/">網路</a></span></div><div class="content">最近面試被問到這個問題，發現裡面觀念牽涉很廣，每個步驟都可以單獨找到很多觀念跟理論，簡單分享以下四個主要的步驟。


1. 輸入網址使用者輸入 (假設 https://google.com/maps/search/shop )因為瀏覽器無法根據 URL (Uniform Resource Locator) 直接定位到對應的資源，而是要根據 ip 才能找到，所以必須進行域名的解析
2. 進行域名解析 DNS(Domain Name System) 得到 IP瀏覽器透過作業系統從中解析出「通訊協定（Protocol）」、「網域（Domain）」、「路徑（Path）」等資訊，經過本地瀏覽器快取及 DNS server 等查找方式來找到跟這些域名對應的 ip 位置
查找 ip 的順序 1. 檢查本地的 DNS 快取 2. 檢查電腦中的 .host 檔 3. 向 DNS 伺服器發送詢問
找到 ip 後丟回給瀏覽器，瀏覽器根據解析出的 IP，開始建立連線
3. TCP (Transmission Control Protocol）開始進行三次握手建立連線透過 TCP&#x2F;IP 協議 (是一種 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/22/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9AMigration/" title="進入Rails世界必須懂：Migration">進入Rails世界必須懂：Migration</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-22T13:56:18.000Z" title="發表於 2022-10-22 21:56:18">2022-10-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">Migration 是什麼就是一個紀錄「資料庫的架構」的檔案，我們可以知道目前資料庫的欄位有什麼？、型態是什麼？，也可以知道目前修改的紀錄與過程。可以跟著 git 一起把資料庫架構變更的進行版本控制。
建立 Migration利用之前 article 的例子來看，先產生一個 article 的 modelrails g model Article title content:text
會長出下面的 migration 紀錄
12345678910class CreateArticles &lt; ActiveRecord::Migration[6.1]  def change    create_table :articles do |t|      t.string :title      t.text :content      t.timestamps    end  endend

看到有 title 及 content 資訊，還有先前文章提到 id (不會顯示) 及 timestamps。
這邊只是先將資料表的內容描述好，需要進行 rails db:migrate 這個指令之 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/22/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9AModel-%E7%9B%B8%E9%97%9C%E4%BB%8B%E7%B4%B9-%E5%8F%8A-CRUD-%E4%B8%8B/" title="進入Rails世界必須懂：Model 相關介紹 及 CRUD (下)">進入Rails世界必須懂：Model 相關介紹 及 CRUD (下)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-21T16:02:25.000Z" title="發表於 2022-10-22 00:02:25">2022-10-22</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">接著上一篇我們繼續說明用 ORM 來操作 CRUD 的部分 關於讀取的部分還可以怎麼去找到，還有後面的 update 及 delete 的說明。
更精準的讀取 find &amp; find_by &amp; Wherefind &amp; find_by
用 find 來找 idModel.find(:id)find_by 可以找特定欄位的資訊是否有對應的資料Model.find_by(欄位名: 值)

兩者的差異：

find 只能找 id，find_by 可以找任何資料表內的東西
find 找不到會出錯， find_by 只會回傳 nil

12345678910113.0.0 :001 &gt; a1 = Article.find(1)  Article Load (0.2ms)  SELECT &quot;articles&quot;.* FROM &quot;articles&quot; WHERE &quot;articles&quot;.&quot;id&quot; = ? LIMIT ?  [[&quot;id&quot;, 1], [&quot;LIMIT&quot ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/19/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9AModel-%E7%9B%B8%E9%97%9C%E4%BB%8B%E7%B4%B9-%E5%8F%8A-CRUD-%E4%B8%8A/" title="進入Rails世界必須懂：Model 相關介紹 及 CRUD (上)">進入Rails世界必須懂：Model 相關介紹 及 CRUD (上)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-19T02:53:52.000Z" title="發表於 2022-10-19 10:53:52">2022-10-19</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">Model前面的章節有提到過 Model 其實就是一個幫忙與資料庫溝通的地方，他既不是資料庫（Database）也不是資料表（Table），Model 可以當成一個抽象類別，負責跟實體的資料表溝通。
CRUD先來簡單說文解字一下這四個基本的字，”CRUD”的意義吧！主要是描述下面這四個字。

Create (C) 新增，建立資料，將定義好的欄位寫入對應的值
Read (R) 讀取，讀取資料，查詢資料的相關內容
Update (U) 更新，更新特定欄位的資料
Delete (D) 刪除，刪除資料

我們可以透過基本的 ORM 操作來感受一下 rails 如何用到上面的這些操作資料的動作吧，操作前先簡單解釋一下相關的專有名詞，也是許多面試常常會問到的觀念。
ORM？ORM 是 Object Relational Mapping 的縮寫，翻譯成「物件關聯對映」。如果想要存取資料庫裡的內容，在以前必須自己撰寫資料庫查詢語言（SQL）對資料庫進行查詢，但透過 ORM 的技術包裝之後，可以讓我們用操作「物件」的方式來操作資料庫。
Active Record?Active Record 是一種設計模 ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/18/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9AController-%E5%8F%8A-View/" title="進入Rails世界必須懂：Controller 及 View">進入Rails世界必須懂：Controller 及 View</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-18T00:59:53.000Z" title="發表於 2022-10-18 08:59:53">2022-10-18</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">開頭先來回顧一下前面的圖片，今天來解釋一下我們 MVC 一直提到的 C (Controller) 及 C (View) 部分，前兩篇講完 routes 的部分，接著當解讀完 routes 之後就是將工作轉往 controller 及 action 的部分，將後續資料的呈現及使用者的動作做完。


Controller 與 Ｖ iew 是什麼呢？Controller 是要拿來做什麼用的？ 從意思來看應該可以看到 control 這個單字，表示是要來進行一些控制的部分，主要是控制資料的流程。他可能會進行：

跟 Model 要資料
把從 Model 收到的資料丟給 View
需要存取外部服務（例如金流串接）等

View 的話則是可以將 Controller 的資料呈現出來，就是一種回傳 HTML 的方法。
和路徑設定的關聯前面一篇提到的文章相關路徑設計，其實我們 resources 後面符號，用複數名稱對應到的就是 controller 的名字
123Rails.application.routes.draw do  resources :articlesend

還記得路徑中有對應的  ...</div></div></div><div class="recent-post-item"><div class="recent-post-info no-cover"><a class="article-title" href="/2022/10/17/Rails/%E9%80%B2%E5%85%A5Rails%E4%B8%96%E7%95%8C%E5%BF%85%E9%A0%88%E6%87%82%EF%BC%9ARoutes-%E4%B8%8B/" title="進入Rails世界必須懂：Routes (下)">進入Rails世界必須懂：Routes (下)</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">發表於</span><time datetime="2022-10-17T00:11:22.000Z" title="發表於 2022-10-17 08:11:22">2022-10-17</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/Rails%E5%9F%BA%E7%A4%8E/">Rails基礎</a></span><span class="article-meta tags"><span class="article-meta-separator">|</span><i class="fas fa-tag"></i><a class="article-meta__tags" href="/tags/Rails/">Rails</a></span></div><div class="content">延續前面基本的路徑設計，這篇會提到比較多種巢狀設計的方式。
巢狀設計方式resources 方法裡面其實還可以在包 resources，在後面會提到 model 之間關連性，例如一個 User 可能會有很多 Articles，Route 可能會這樣寫：
12345Rails.application.routes.draw do  resources :users do    resource :articles  endend

終端機輸入 $ rails routes -c articles 查詢路徑可以看到如下
12345678            Prefix Verb   URI Pattern                             Controller#Action new_user_articles GET    /users/:user_id/articles/new(.:format)  articles#newedit_user_articles GET    /users/:user_id/articles/edit(.:format) arti ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/#content-inner">3</a><a class="page-number" href="/page/4/#content-inner">4</a><a class="extend next" rel="next" href="/page/3/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/profile2.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Sean</div><div class="author-info__description">JAVA 後端工程師，嘗試寫下文章記錄自己的所見所聞。</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">38</div></a><a href="/tags/"><div class="headline">標籤</div><div class="length-num">24</div></a><a href="/categories/"><div class="headline">分類</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/oSeanChen"><i class="fab fa-github"></i><span>To My GitHub</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="mailto:abbb123p@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2024/02/16/JPA,%20JDBC,%20Hibernate/" title="JPA, JDBC, Hibernate">JPA, JDBC, Hibernate</a><time datetime="2024-02-16T13:57:25.000Z" title="發表於 2024-02-16 21:57:25">2024-02-16</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/08/23/%E7%B7%A8%E7%A2%BC-encoding-vs-%E5%8A%A0%E8%A7%A3%E5%AF%86-vs-%E9%9B%9C%E6%B9%8A-Hash/" title="編碼(encoding) vs 加解密 vs 雜湊(Hash)">編碼(encoding) vs 加解密 vs 雜湊(Hash)</a><time datetime="2023-08-23T10:01:35.000Z" title="發表於 2023-08-23 18:01:35">2023-08-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/22/Java/equals-%E5%92%8C-%E5%B7%AE%E5%88%A5/" title=".equals() 和 == 差別">.equals() 和 == 差別</a><time datetime="2023-05-22T15:17:27.000Z" title="發表於 2023-05-22 23:17:27">2023-05-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/22/Java/StringUtils-%E5%B8%B8%E7%94%A8%E5%88%A4%E6%96%B7%E5%AD%97%E4%B8%B2%E6%96%B9%E6%B3%95%E8%88%87-Java-%E5%85%A7%E5%BB%BA%E6%96%B9%E6%B3%95%E6%AF%94%E8%BC%83/" title="StringUtils 常用判斷字串方法與 Java 內建方法比較">StringUtils 常用判斷字串方法與 Java 內建方法比較</a><time datetime="2023-05-22T14:49:33.000Z" title="發表於 2023-05-22 22:49:33">2023-05-22</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2023/05/10/SpringBoot/Spring-restTemplate-%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/" title="Spring restTemplate 使用方法">Spring restTemplate 使用方法</a><time datetime="2023-05-09T16:02:54.000Z" title="發表於 2023-05-10 00:02:54">2023-05-10</time></div></div></div></div><div class="card-widget card-categories"><div class="item-headline">
            <i class="fas fa-folder-open"></i>
            <span>分類</span>
            <a class="card-more-btn" href="/categories/" title="檢視更多">
    <i class="fas fa-angle-right"></i></a>
            </div>
            <ul class="card-category-list" id="aside-cat-list">
            <li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java-Basic/"><span class="card-category-list-name">Java Basic</span><span class="card-category-list-count">5</span></a><ul class="card-category-list child"><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Java-Basic/Spring-Boot/"><span class="card-category-list-name">Spring Boot</span><span class="card-category-list-count">1</span></a></li></ul></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/RabbitMQ/"><span class="card-category-list-name">RabbitMQ</span><span class="card-category-list-count">1</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Rails%E5%9F%BA%E7%A4%8E/"><span class="card-category-list-name">Rails基礎</span><span class="card-category-list-count">10</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Rails%E5%A5%97%E4%BB%B6/"><span class="card-category-list-name">Rails套件</span><span class="card-category-list-count">4</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Ruby%E5%9F%BA%E7%A4%8E/"><span class="card-category-list-name">Ruby基礎</span><span class="card-category-list-count">13</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/Spring-Boot/"><span class="card-category-list-name">Spring Boot</span><span class="card-category-list-count">2</span></a></li><li class="card-category-list-item "><a class="card-category-list-link" href="/categories/%E5%AF%86%E7%A2%BC%E5%AD%B8/"><span class="card-category-list-name">密碼學</span><span class="card-category-list-count">1</span></a></li>
            </ul></div><div class="card-widget card-tags"><div class="item-headline"><i class="fas fa-tags"></i><span>標籤</span></div><div class="card-tag-cloud"><a href="/tags/Omniauth/" style="font-size: 1.17em; color: #999c9f">Omniauth</a> <a href="/tags/google/" style="font-size: 1.17em; color: #999c9f">google</a> <a href="/tags/github/" style="font-size: 1.17em; color: #999c9f">github</a> <a href="/tags/Devise/" style="font-size: 1.3em; color: #99a1ac">Devise</a> <a href="/tags/REST/" style="font-size: 1.17em; color: #999c9f">REST</a> <a href="/tags/%E7%B7%A8%E7%A2%BC/" style="font-size: 1.1em; color: #999">編碼</a> <a href="/tags/%E7%89%A9%E4%BB%B6%E5%B0%8E%E5%90%91/" style="font-size: 1.1em; color: #999">物件導向</a> <a href="/tags/%E5%A5%97%E4%BB%B6/" style="font-size: 1.3em; color: #99a1ac">套件</a> <a href="/tags/%E6%9C%83%E5%93%A1%E7%B3%BB%E7%B5%B1/" style="font-size: 1.3em; color: #99a1ac">會員系統</a> <a href="/tags/Asynchronous/" style="font-size: 1.1em; color: #999">Asynchronous</a> <a href="/tags/%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88/" style="font-size: 1.1em; color: #999">程式設計</a> <a href="/tags/Oauth/" style="font-size: 1.17em; color: #999c9f">Oauth</a> <a href="/tags/http-request/" style="font-size: 1.17em; color: #999c9f">http request</a> <a href="/tags/RabbitMQ/" style="font-size: 1.1em; color: #999">RabbitMQ</a> <a href="/tags/%E5%8A%A0%E5%AF%86/" style="font-size: 1.1em; color: #999">加密</a> <a href="/tags/%E7%B6%B2%E8%B7%AF/" style="font-size: 1.1em; color: #999">網路</a> <a href="/tags/Rails/" style="font-size: 1.43em; color: #99a6b9">Rails</a> <a href="/tags/Message-Queue/" style="font-size: 1.1em; color: #999">Message Queue</a> <a href="/tags/Ruby/" style="font-size: 1.5em; color: #99a9bf">Ruby</a> <a href="/tags/i18n/" style="font-size: 1.1em; color: #999">i18n</a> <a href="/tags/RESTful/" style="font-size: 1.17em; color: #999c9f">RESTful</a> <a href="/tags/Spring-Boot/" style="font-size: 1.23em; color: #999ea6">Spring Boot</a> <a href="/tags/%E9%9B%9C%E6%B9%8A%E6%BC%94%E7%AE%97/" style="font-size: 1.1em; color: #999">雜湊演算</a> <a href="/tags/Java/" style="font-size: 1.37em; color: #99a4b2">Java</a></div></div><div class="card-widget card-archives"><div class="item-headline"><i class="fas fa-archive"></i><span>歸檔</span><a class="card-more-btn" href="/archives/" title="檢視更多">
    <i class="fas fa-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/05/"><span class="card-archive-list-date">五月 2023</span><span class="card-archive-list-count">4</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/04/"><span class="card-archive-list-date">四月 2023</span><span class="card-archive-list-count">2</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/03/"><span class="card-archive-list-date">三月 2023</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/11/"><span class="card-archive-list-date">十一月 2022</span><span class="card-archive-list-count">1</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/10/"><span class="card-archive-list-date">十月 2022</span><span class="card-archive-list-count">14</span></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2022/09/"><span class="card-archive-list-date">九月 2022</span><span class="card-archive-list-count">1</span></a></li></ul></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>網站資訊</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章數目 :</div><div class="item-count">38</div></div><div class="webinfo-item"><div class="item-name">已執行時間 :</div><div class="item-count" id="runtimeshow" data-publishDate="2022-08-11T16:00:00.000Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站訪客數 :</div><div class="item-count" id="busuanzi_value_site_uv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">本站總訪問量 :</div><div class="item-count" id="busuanzi_value_site_pv"><i class="fa-solid fa-spinner fa-spin"></i></div></div><div class="webinfo-item"><div class="item-name">最後更新時間 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-02-16T15:14:37.707Z"><i class="fa-solid fa-spinner fa-spin"></i></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By Sean</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主題 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="淺色和深色模式轉換"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="單欄和雙欄切換"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="設定"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到頂部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"><script>window.typedJSFn = {
  init: (str) => {
    window.typed = new Typed('#subtitle', Object.assign({
      strings: str,
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50,
    }, null))
  },
  run: (subtitleType) => {
    if (true) {
      if (typeof Typed === 'function') {
        subtitleType()
      } else {
        getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
      }
    } else {
      subtitleType()
    }
  }
}
</script><script>function subtitleType () {
  if (true) {
    typedJSFn.init(["程式世界冒險即將開始...","Coding everywhere and thinking everywhere."])
  } else {
    document.getElementById("subtitle").innerHTML = '程式世界冒險即將開始...'
  }
}
typedJSFn.run(subtitleType)</script><script>(() => {
  const $mermaidWrap = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaidWrap.length) {
    window.runMermaid = () => {
      window.loadMermaid = true
      const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

      Array.from($mermaidWrap).forEach((item, index) => {
        const mermaidSrc = item.firstElementChild
        const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
        const mermaidID = 'mermaid-' + index
        const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent
        mermaid.mermaidAPI.render(mermaidID, mermaidDefinition, (svgCode) => {
          mermaidSrc.insertAdjacentHTML('afterend', svgCode)
        })
      })
    }

    const loadMermaid = () => {
      window.loadMermaid ? runMermaid() : getScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js').then(runMermaid)
    }

    window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜尋</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  資料庫載入中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜尋文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></body></html>